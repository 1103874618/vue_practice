<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Page Title</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link rel="stylesheet" href="../../common/bootstrap.css">
  <script src="../../common/vue.js"></script>
</head>

<style>
  .container {
      width: 40%;
      margin: 20px auto 0px auto;
    }
    .removed label {
      text-decoration: line-through;
    }
    ul li {
      list-style-type: none;
    }
    ul li span {
      margin-left: 5px;
    }
    .footer {
      font-size: 0.7em;
      margin-top: 20vh;
    }
  </style>

<body>
  <!--add new item template -->
  <template id="add-item-template">
    <div class="input-group">
      <input @keyup.enter="addItem" v-model="newItem" placeholder="add shopping list item" type="text" class="form-control">
      <span class="input-group-btn">
        <button @click="addItem" class="btn btn-default" type="button">Add!</button>
      </span>
    </div>
  </template>

  <!--list item template-->
  <template id="item-template">
    <li :class="{ 'removed': item.checked }">
      <div class="checkbox">
        <label>
          <input type="checkbox" v-model="item.checked"> {{ item.text }}
        </label>
      </div>
    </li>
  </template>

  <template id="items-template">
    <ul>
      <item-component v-for="item in items" :item="item"> </item-component>
    </ul>
  </template>
  <!-- 同样是因为子组件不能影响父组件的值,所以只能用事件系统 -->
  <template id="change-title-template">
    <div>
      <em>Change the title of your shopping list here</em>
      <input v-bind:value="value" v-on:input="onInput" />
    </div>
  </template>



  <div id="app" class="container">
    <h2>{{ title }}</h2>
    <add-item-component :items="items" v-on:add="addItem"></add-item-component>
    <items-component :items="items"></items-component><!-- 它的items跟vue全局数据的items绑定 -->
    <div class="footer">
      <hr />
      <change-title-component v-model='title'></change-title-component><!-- vue数据title跟组件的某个值绑定 -->
    </div>
  </div>

  <script>
    var data = {
      items: [{
        text: "Bananas",
        checked: true
      }, {
        text: "Apples",
        checked: false
      }],
      title: "My Shopping List",
    };
    Vue.component('add-item-component', {
      template: "#add-item-template",
      data: function () {
        return {
          newItem: ''
        }
      },
      methods: {
        addItem: function () {
          var text;
          text = this.newItem.trim();
          if (text) {
            this.$emit('add', this.newItem);
            this.newItem = '';
          }
        }
      }
    });


    Vue.component('item-component', {
      template: "#item-template",
      props: ['item']
      //另外，不要忘记传递父应用程序属性的props属性
    });

    Vue.component('items-component', {
      template: "#items-template",
      props: ['items']

    });

    Vue.component("change-title-component", {
      template: "#change-title-template",
      props: ['value'],
      methods: {
        onInput: function (event) {
          this.$emit('input', event.target.value)
          //emit是用来触发事件的,$emit相当于jq中的trigger事件，只不过是用子组件来触发父组件的方法。所以里面的this是父组件。(如果有父组件的话)
        }
      }
      //我gtmd,这个methods我的代码明明和原作者一样偏偏会报错,找到了导致报错的地方,代码明明一样,复制原作的代码过来就不报错了???????
    });

    new Vue({
      el: '#app',
      data: data,
      methods: {
        // 这个方法应该检查new item属性，如果它包含文本，应该会发出一个事件。让我们称此事件为add。
        // 所以它只接收已经处理过的文本，并将其推入项目数组中
        addItem: function (text) {
          this.items.push({
            text: text,
            checked: false
          });
        },
      },
    });
  </script>

</body>

</html>